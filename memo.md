## IAM 계정이 Cost and usage에 접근이 불가능한 문제
- 증상
  - IAM 계정에 AWSBillingReadOnlyAccess와 Billing 권한을 부여했음에도 Cost and usage에 접근이 불가능하다고 한다.
- 해결 방법
  - 루트 계정에 AWS 콘솔 접속
  - 우상단의 계정 클릭 후 Account로 이동
  - 이동한 계정 설정 페이지에서 IAM user and role access to Billing information 찾기
  - Edit 버튼을 눌러 IAM user/role access to billing information 활설화
  - IAM 계정이 Cost and usage에 접근 가능한지 확인
- 참고
  - [IAM 사용자 AWS 결제 대시보드 접근 설정 방법](https://byounghee.tistory.com/315)

## 웹 페이지 배포하기
- 과정: AWS Amplify + Git을 활용하여 진행
  - 우선 AWS CLI와 사용할 IAM 계정의 액세스 키가 요구됨
  - [AWS CLI 설치](https://docs.aws.amazon.com/cli/latest/userguide/getting-started-install.html)
  - IAM 계정의 액세스 키 생성하기
    - AWS 콘솔의 우상단의 계정을 클릭하여 [보안 자격 증명] 메뉴로 이동
    - 보안 자격 증명 설정 페이지에서 스크롤하여 [액세스 키] 항목으로 이동
    - 새로운 액세스 키를 만들어 보안상으로 안전한 곳에 csv로 저장하거나 메모해둘 것
  - 터미널에서 `aws configure` 커맨드 실행 후, 액세스 키와 비밀 액세스 키와 리전을 입력
  - `aws s3 cp s3://wildrydes-us-east-1/WebApplication/1_StaticWebHosting/website ./ --recursive` 커맨드 실행
  - 만들어놓은 GitHub 레포지토리에 해당 코드 push
  - AWS Amplify를 GitHub 레포지토리와 연계하여 웹에 배포하기
    - Amplify 콘솔에서 새로운 앱 만들기 (이 떄 [웹 앱 호스팅]으로 만들어줘야 함)
    - [기존 코드에서] 항목 중 [GitHub] 선택
    - (GitHub 계정에 연결되어 있지 않은 경우) 권한을 부여함으로써 연결
    - 만들어놓은 GitHub 레포지토리 -> 메인 브랜치 선택
    - (모노레포인 경우) 모노레포에 체크한 뒤 해당하는 디렉토리 입력
    - [AWS Amplify가 프로젝트 루트 디렉터리에 호스팅된 모든 파일을 자동으로 배포하도록 허용] 체크
    - 다음으로 넘어가 [저장 및 배포]
  - AWS Amplify에서 확인된 배포 링크에 잘 들어가지는지 확인
- 참고
  - [AWS - 서버리스 웹 애플리케이션 구축 - 모듈 1: 지속적인 배포를 통한 정적 웹 호스팅](https://aws.amazon.com/ko/getting-started/hands-on/build-serverless-web-app-lambda-apigateway-s3-dynamodb-cognito/module-1/)
  - [AWS - Install or update the latest version of the AWS CLI](https://docs.aws.amazon.com/cli/latest/userguide/getting-started-install.html)
  - [AWS - Managing access keys for IAM users](https://docs.aws.amazon.com/IAM/latest/UserGuide/id_credentials_access-keys.html#Using_CreateAccessKey)

## 사용자 풀 만들기
- Amazon SES 설정 필요
  - Amazon SES 콘솔 -> 구성 -> 확인된 자격 증명 -> 자격 증명 생성
  - 자격 증명 세부 정보에서 [보안 인증 유형]을 [이메일 주소]로 선택
  - 이메일 주소 입력 후, 전송된 확인 메일의 링크로 인증 절차 완료하기
- Amazon Cognito 콘솔에서 [사용자 풀 생성]
  - [로그인 환경 구성]의 [Cognito 사용자 풀 로그인 옵션] 섹션에서 [사용자 이름]을 선택 후 다음으로 넘어가기
  - [보안 요구 사항 구성]에서 [암호 정책 모드]를 [Cognito 기본값]으로 유지 후 [MFA 없음]을 선택하고 다음으로 넘어가기
  - [가입 환경 구성]은 건들지 않고 다음으로 넘어가기
  - [메시지 전송 구성]에서 [이메일 공급자]가 [Amazon SES를 사용하여 이메일 전송 - 권장됨]으로 되어있는지 확인 후, [발신 이메일 주소]에서 Amazon SES에서 설정한 이메일 선택하고 다음으로 넘어가기
  - [앱 통합]에서 사용자 풀 이름 짓기
  - [초기 앱 클라이언트]에서 앱 클라이언트 이름 짓기
  - [검토 및 생성]에서 사용자 풀 생성 완료하기
- 상단의 과정에서 배포했던 웹 페이지의 [/js/config.js] 파일 편집하기
  - Amazon Cognito 콘솔로 들어가 이전 과정에서 진행했던 사용자 풀 확인
  - userPoolID: [사용자 풀 개요]의 사용자 풀 ID
  - userPoolClientID: [앱 통합] > [앱 클라이언트 및 분석]에 있는 앱 클라이언트 ID
  - region: [사용자 풀 개요]에서 [풀 ARN] 값 참고
  - invokeUrl은 일단 비워둔다
  - 파일 저장 후 커밋 푸시
- 구현이 되었는지 확인
  - AWS Amplify에 배포됐던 페이지에서 가입 진행 후 로그인 여부 확인
- 참고
  - [AWS - 서버리스 웹 애플리케이션 구축 - 모듈 2: 사용자 관리](https://aws.amazon.com/ko/getting-started/hands-on/build-serverless-web-app-lambda-apigateway-s3-dynamodb-cognito/module-2/)
  - [Amazon SES에서 자격 증명 생성 및 확인 - 이메일 주소 자격 증명 생성](https://docs.aws.amazon.com/ko_kr/ses/latest/dg/creating-identities.html#verify-email-addresses-procedure)
